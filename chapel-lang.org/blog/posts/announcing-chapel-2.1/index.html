<!DOCTYPE html>

<html data-theme="light" lang="en"><head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1" name="viewport"/>
<meta content="#00cbff" name="theme-color"/>
<meta content="A summary of highlights from the June 2024 release of Chapel 2.1" name="description"/>
<link href="//cdnjs.cloudflare.com/ajax/libs/normalize/5.0.0/normalize.min.css" media="screen,print" rel="stylesheet"/>
<style>.sidenote-checkbox { display: none; }</style>
<style>.feather { width: 1rem; height: 1rem; }</style>
<link href="../../scss/style.min.css" media="screen,print" rel="stylesheet"/>
<link href="../../scss/sidenotes.min.css" media="screen,print" rel="stylesheet"/>
<link href="../../css/syntax.min.css" media="screen,print" rel="stylesheet"/>
<link href="../../scss/syntax-terminal.min.css" media="screen,print" rel="stylesheet"/>
<link href="../../scss/code.min.css" media="screen,print" rel="stylesheet"/>
<link href="../../img/favicon.ico" rel="icon" type="image/png"/>
<script defer="" src="../../js/dropdown-menu.js"></script>
<title>Announcing Chapel 2.1!</title>
</head>
<body>
<header>
<div class="container">
<a class="site-title" href="../../">
<img alt="Chapel logo" height="50" src="../../img/logo.png" width="50"/>
<h1>Chapel Language Blog</h1>
</a>
</div>
<nav id="Header">
<div class="container">
<a href="../../about">About</a>
<a href="https://chapel-lang.org">Chapel Website</a>
<a href="../../featured">Featured</a>
<a href="../../series">Series</a>
<a href="../../tags">Tags</a>
<a href="../../authors">Authors</a>
<a href="../../posts">All Posts</a>
</div>
</nav>
</header>
<main class="container">
<h2>Announcing Chapel 2.1!</h2>
<div class="post-subscript">
<p>Posted on June 27, 2024.</p>
<p>
        Tags:
        
        <a class="button" href="../../tags/release-announcements">Release Announcements</a>
</p>
<p>
    By:
    <a href="../../authors/brad-chamberlain">Brad Chamberlain</a>
</p>
</div>
<div class="post-content">
<div class="table-of-contents">
<div class="wrapper">
<span class="header">Table of Contents</span>
<nav id="TableOfContents">
<ul>
<li><a href="#installationportability-improvements">Installation/Portability Improvements</a>
<ul>
<li><a href="#spack">Spack</a></li>
<li><a href="#linux-packages">Linux Packages</a></li>
<li><a href="#homebrew">Homebrew</a></li>
<li><a href="#aws-efa">AWS EFA</a></li>
</ul>
</li>
<li><a href="#remote-variable-declarations">Remote Variable Declarations</a></li>
<li><a href="#gpu-reductions">GPU Reductions</a></li>
<li><a href="#other-chapel-21-highlights">Other Chapel 2.1 Highlights</a></li>
<li><a href="#for-more-information">For More Information</a></li>
</ul>
</nav>
</div>
</div>
<p>The Chapel developer community is pleased to announce the release of
version 2.1 of Chapel!  This release builds on March’s <a href="../../posts/announcing-chapel-2.0/">milestone
2.0 release</a> by
significantly expanding Chapel’s installation options and improving
support for AWS. It also adds powerful new features like remote
variable declarations and language support for GPU reductions.  In
this post, I’ll provide an overview of these advances and
summarize a few other highlights.</p>
<h3 id="installationportability-improvements">
<a href="#installationportability-improvements">Installation/Portability Improvements</a>
</h3>
<p>A big theme of the Chapel project since completing the 2.0 release
has been thinking expansively about <span class="sidenote"><label class="sidenote-label" for="sidenote-0">nurturing and growing the Chapel community</label><input class="sidenote-checkbox" id="sidenote-0" type="checkbox"/><span class="sidenote-content sidenote-right"><span class="sidenote-delimiter">[note:</span>For those
interested, I introduced this theme and ran through some of our
recent efforts here in my “State of the Chapel Project” talk at
<a href="../../posts/chapelcon24/">ChapelCon ‘24</a> whose
<a href="https://chapel-lang.org/chapelcon/2024/chamberlain-sop.pdf" rel="noopener" target="_blank">slides</a> and
<a href="https://www.youtube.com/watch?v=nfxJ-tOsgrY&amp;amp;list=PLuqM5RJ2KYFi2yV4sFLc6QeRYpS35UeKl&amp;amp;index=2&amp;amp;pp=iAQB" rel="noopener" target="_blank">video</a>
are available online.<span class="sidenote-delimiter">]</span></span></span>.  One effort we’ve kicked
off as a result of this seeks to improve and diversify the options
for installing Chapel on a given system.</p>
<p>Specifically, where we have traditionally supported Chapel system
installations through source builds, Homebrew, Docker, and the
HPE/Cray module systems, in Chapel 2.1, we’ve added new installation
options and improved some of the existing ones.  Here are some of
the highlights:</p>
<h4 id="spack">
<a href="#spack">Spack</a>
</h4>
<p>The first—and to me, most exciting—new installation option is a
full-fledged <a href="https://packages.spack.io/package.html?name=chapel" rel="noopener" target="_blank">Chapel Spack
package</a>.  If
you’re not familiar with
<a href="https://github.com/spack/spack#readme" rel="noopener" target="_blank">Spack</a>, think of it as the
package manager of choice for HPC systems—though it works great on
laptops and workstations as well!  Spack’s development was led by
HPC experts at LLNL, and was designed with a supercomputer’s needs
and configurations in mind, where traditional package managers have
typically fallen short.</p>
<p>If you’ve built Chapel from source, you’re likely aware of the wide
variety of knobs and configuration options that can be used to
customize the installation.  The Chapel Spack package exposes these
options as Spack <em>variants</em>, while also leveraging Chapel’s existing
logic to pick reasonable defaults for a given system or network.</p>
<p>To get started with Chapel in Spack, refer to its new <a href="https://chapel-lang.org/install-spack.html" rel="noopener" target="_blank">Installing
via Spack</a> webpage.  And
thanks very much to Dan Bonachea (LBNL) and Peter
Scheibel (LLNL) for their considerable help in reviewing,
testing, and improving this new Chapel package during its
development.</p>
<h4 id="linux-packages">
<a href="#linux-packages">Linux Packages</a>
</h4>
<p>If you manage a Linux system and prefer using its native package
manager, for Chapel 2.1, we’ve started releasing Chapel as RPMs and
Debian (<code>.deb</code>) packages.  This simplifies installation on popular
Linux systems such as Ubuntu, Debian, Fedora, and RHEL by only
requiring a download and a single <code>dnf install</code> or <code>apt install</code>
command to get started.</p>
<p>Currently, these packages are being made available in single-locale
formats for those wanting to run on their Linux laptop or
workstation.  For many flavors of Linux, we’re also releasing
multi-locale versions that support running on commodity clusters.</p>
<p>Our multi-locale packages are currently built using Chapel’s
GASNet-EX/UDP configuration for portability.  This permits these
packages to run on any network that supports TCP/IP, such as
Ethernet.  In the future, we plan to add additional packages to
support high-performance networks like InfiniBand.  We also
anticipate supporting more package managers over time.  If there are
specific configurations that you would like to see prioritized,
please let us know!</p>
<p>To learn more about this installation option, see our new
<a href="https://chapel-lang.org/install-pkg.html" rel="noopener" target="_blank">Installing Chapel using Linux Package
Managers</a> page.</p>
<h4 id="homebrew">
<a href="#homebrew">Homebrew</a>
</h4>
<p>Homebrew is a package manager that we’ve supported for some time
now, and an important one due to its popularity in the Mac OS X
community.  In Chapel 2.1, we’ve improved our Homebrew formula
to use the preferred single-locale configuration, leveraging
<a href="https://www.sandia.gov/qthreads/" rel="noopener" target="_blank">Qthreads</a> from Sandia National
Labs, <a href="https://www.open-mpi.org/projects/hwloc/" rel="noopener" target="_blank">hwloc</a> from the
OpenMPI community, and <a href="https://jemalloc.net/" rel="noopener" target="_blank">jemalloc</a>.  These
changes should result in performance boosts and better utilization
of desktop hardware, particularly for workstations that have a mix
of performance and efficiency cores.</p>
<p>To leverage these improvements, see <a href="https://chapel-lang.org/install-homebrew.html" rel="noopener" target="_blank">Installing Chapel using
Homebrew</a>.</p>
<h4 id="aws-efa">
<a href="#aws-efa">AWS EFA</a>
</h4>
<p>Another aspect of deploying Chapel that we’ve been working on for
version 2.1 is getting it running well on cloud providers, such as
AWS (Amazon Web Services).  Specifically, we’ve made a lot of great
progress improving Chapel execution using AWS’s Elastic Fabric
Adapter (EFA) network interface, in terms of both stability and
correctness.  In future releases, we plan to support pre-packaged
installations of Chapel for AWS/EFA, but in the meantime, we’ve
updated our <a href="https://chapel-lang.org/docs/2.1/platforms/aws.html" rel="noopener" target="_blank">Using Chapel on Amazon Web
Services</a>
documentation to reflect current best practices.</p>
<h3 id="remote-variable-declarations">
<a href="#remote-variable-declarations">Remote Variable Declarations</a>
</h3>
<p>Chapel 2.1 provides a prototype implementation of a feature that’s
been planned since Chapel’s inception, yet never implemented.  The
idea is to prefix a variable declaration with a traditional
<code>on</code>-clause to have the variable be allocated on a specific locale:</p>
<div class="highlight" data-code-path="code/announcing-chapel-2.1.chpl" data-code-section="middle" data-code-type="main" data-start-line="1"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma" tabindex="0"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre class="chroma" tabindex="0"><code class="language-Chapel" data-lang="Chapel"><span class="line"><span class="cl"><span class="w">  </span><span class="k">on</span><span class="w"> </span><span class="nx">Locales</span><span class="p">.</span><span class="nx">last</span><span class="w"> </span><span class="kd">var</span><span class="w"> </span><span class="nx">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">42</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nx">writeln</span><span class="p">(</span><span class="s">"I'm running on locale "</span><span class="p">,</span><span class="w"> </span><span class="nx">here</span><span class="p">.</span><span class="nx">id</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">          </span><span class="s">", but x is stored on "</span><span class="p">,</span><span class="w"> </span><span class="nx">x</span><span class="p">.</span><span class="kt">locale</span><span class="p">.</span><span class="nx">id</span><span class="p">);</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>The benefit of this feature is that it permits a variable to be
stored anywhere on the system, yet without having its lifetime be
bound to the lexical scope that a traditional <code>on</code>-clause would
introduce:</p>
<div class="highlight" data-code-path="code/announcing-chapel-2.1.chpl" data-code-section="middle" data-code-type="main" data-start-line="5"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma" tabindex="0"><code><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre class="chroma" tabindex="0"><code class="language-Chapel" data-lang="Chapel"><span class="line"><span class="cl"><span class="w">  </span><span class="k">on</span><span class="w"> </span><span class="nx">Locales</span><span class="p">.</span><span class="nx">last</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">var</span><span class="w"> </span><span class="nx">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">42</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nx">writeln</span><span class="p">(</span><span class="s">"I'm running on locale "</span><span class="p">,</span><span class="w"> </span><span class="nx">here</span><span class="p">.</span><span class="nx">id</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="s">", and x is too ("</span><span class="p">,</span><span class="w"> </span><span class="nx">x</span><span class="p">.</span><span class="kt">locale</span><span class="p">.</span><span class="nx">id</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="s">"), but only for this on-clause's scope"</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="p">}</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>Until now, Chapel’s classes were the only other way to decouple a
variable’s location from its scope, but that approach requires more
code and effort to declare the class and manage its lifetime.  For
simple cases like the one above, it ends up feeling like overkill.</p>
<p>This new remote variable feature is particularly important for
programming GPUs with Chapel since the top-level control logic can
run on the CPU while declaring variables that are allocated in GPU
memory and used across multiple GPU kernel launches.</p>
<p>To learn more about this feature, refer to the <a href="https://chapel-lang.org/docs/2.1/technotes/remote.html" rel="noopener" target="_blank">Remote Variable
Declarations</a>
tech note in Chapel’s documentation.</p>
<h3 id="gpu-reductions">
<a href="#gpu-reductions">GPU Reductions</a>
</h3>
<p>Speaking of GPUs, Chapel 2.1 continues to advance Chapel’s support
for GPU programming through a number of feature improvements and bug
fixes.</p>
<p>As a specific example, in Chapel 2.0, computing a reduction of an
array to a scalar using a GPU required calling to library routines
like <code>gpuSumReduce(myGpuArray)</code>.  For Chapel 2.1, we have extended
Chapel’s <code>reduce</code> expressions and intents so that traditional Chapel
patterns like:</p>
<div class="highlight"><pre class="chroma" tabindex="0"><code class="language-chapel" data-lang="chapel"><span class="line"><span class="cl"><span class="kd">var</span><span class="w"> </span><span class="nx">sum</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="k">reduce</span><span class="w"> </span><span class="nx">myGpuArray</span><span class="p">;</span><span class="w">
</span></span></span></code></pre></div><p>or:</p>
<div class="highlight"><pre class="chroma" tabindex="0"><code class="language-chapel" data-lang="chapel"><span class="line"><span class="cl"><span class="kd">var</span><span class="w"> </span><span class="nx">sum</span><span class="p">:</span><span class="w"> </span><span class="kt">real</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">forall</span><span class="w"> </span><span class="nx">i</span><span class="w"> </span><span class="kd">in</span><span class="w"> </span><span class="mi">1</span><span class="o">..</span><span class="nx">n</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="p">(</span><span class="o">+</span><span class="w"> </span><span class="k">reduce</span><span class="w"> </span><span class="nx">sum</span><span class="p">)</span><span class="w"> </span><span class="k">do</span><span class="w"> </span><span class="o">..</span><span class="p">.</span><span class="w">
</span></span></span></code></pre></div><p>can now be used to execute the reduction on a GPU.</p>
<p>For more information about Chapel on GPUs, please refer to our
ongoing <a href="../../series/gpu-programming-in-chapel/">GPU Programming in
Chapel</a>
blog series or the <a href="https://chapel-lang.org/docs/2.1/technotes/gpu.html" rel="noopener" target="_blank">GPU
Programming</a>
tech note.</p>
<h3 id="other-chapel-21-highlights">
<a href="#other-chapel-21-highlights">Other Chapel 2.1 Highlights</a>
</h3>
<p>In addition to the items called out above, Chapel 2.1 contains many
other improvements in terms of features, performance, documentation,
and bug fixes, many of which have been motivated by user feedback or
requests.  Here are a few highlights:</p>
<ul>
<li>
<p>We have added the ability to automatically resolve warnings in
Chapel’s linter, along with a number of new warnings for various
coding issues.  We also added the ability to list what rules are
available and which are enabled.  For more information, see, the
<a href="https://chapel-lang.org/docs/2.1/tools/chplcheck/chplcheck.html" rel="noopener" target="_blank"><code>chplcheck</code></a>
documentation.</p>
</li>
<li>
<p>The LSP-based Chapel Language Server (CLS) has advanced in a
number of ways that improve the user experience, such as reasoning
about <code>use</code> and <code>import</code> statements, as well as providing better
error information in hover-based messages.  Further information
can be found on the
<a href="https://chapel-lang.org/docs/2.1/tools/chpl-language-server/chpl-language-server.html" rel="noopener" target="_blank"><code>chpl-language-server</code></a> page.</p>
</li>
<li>
<p>We’ve added a new
<a href="https://chapel-lang.org/docs/2.1/modules/packages/Image.html" rel="noopener" target="_blank">Image</a>
package module that contains initial support for writing out image
files.</p>
</li>
<li>
<p>We’ve also extended package modules like
<a href="https://chapel-lang.org/docs/2.1/modules/packages/ConcurrentMap.html" rel="noopener" target="_blank">ConcurrentMap</a>
and
<a href="https://chapel-lang.org/docs/2.1/modules/packages/EpochManager.html" rel="noopener" target="_blank">EpochManager</a>
to support Arm processors through portability improvements to the
<a href="https://chapel-lang.org/docs/2.1/modules/packages/AtomicObjects.html" rel="noopener" target="_blank">AtomicObjects</a>
package.</p>
</li>
</ul>
<p>For a more complete list of changes in this release, please refer to
its
<a href="https://github.com/chapel-lang/chapel/blob/release/2.1/CHANGES.md" rel="noopener" target="_blank">CHANGES.md</a>
file.  And thanks to <a href="https://github.com/chapel-lang/chapel/blob/release/2.1/CONTRIBUTORS.md" rel="noopener" target="_blank">everyone who
contributed</a>
to Chapel 2.1!</p>
<h3 id="for-more-information">
<a href="#for-more-information">For More Information</a>
</h3>
<p>If you have questions about the release or its new features, please
reach out on Chapel’s <a href="https://chapel.discourse.group/" rel="noopener" target="_blank">Discourse
community</a> or one of our other
<a href="https://chapel-lang.org/community.html" rel="noopener" target="_blank">community forums</a>.  As
always, we’re interested in feedback on how we can make the Chapel
language, libraries, implementation, and tools more useful to you.</p>
</div>
</main>
<div class="container">
<div class="share-view">
<h3>Share this article:</h3>
<div class="share-buttons">
<a class="button share-button" href="https://bsky.app/intent/compose?text=Check+out+this+post+entitled+%22Announcing+Chapel+2.1%21%22+on+the+Chapel+Programming+Language+blog%3A+https%3A%2F%2Fchapel-lang.org%2Fblog%2Fposts%2Fannouncing-chapel-2.1%2F" rel="noopener noreferrer" style="--button-color: #6cb0f9; --button-color-light: white;" target="_blank">
<img alt="Share on BlueSky" height="30" src="../../img/bluesky-logo.jpg" width="30"/>
</a>
<a class="button share-button" href="https://www.facebook.com/sharer/sharer.php?description=Check+out+this+post+entitled+%22Announcing+Chapel+2.1%21%22+on+the+Chapel+Programming+Language+blog%3A&amp;u=https%3A%2F%2Fchapel-lang.org%2Fblog%2Fposts%2Fannouncing-chapel-2.1%2F" rel="noopener noreferrer" style="--button-color: #3a559f; --button-color-light: white;" target="_blank">
<img alt="Share on Facebook" height="30" src="../../img/facebook-logo.png" width="30"/>
</a>
<a class="button share-button" href="https://linkedin.com/share?text=Check+out+this+post+entitled+%22Announcing+Chapel+2.1%21%22+on+the+Chapel+Programming+Language+blog%3A&amp;url=https%3A%2F%2Fchapel-lang.org%2Fblog%2Fposts%2Fannouncing-chapel-2.1%2F" rel="noopener noreferrer" style="--button-color: #2867b2; --button-color-light: white;" target="_blank">
<img alt="Share on LinkedIn" height="30" src="../../img/linkedin-logo.png" width="30"/>
</a>
<a class="button share-button" href="https://new.reddit.com/submit?title=Announcing+Chapel+2.1%21&amp;url=https%3A%2F%2Fchapel-lang.org%2Fblog%2Fposts%2Fannouncing-chapel-2.1%2F" rel="noopener noreferrer" style="--button-color: #ff4500; --button-color-light: white;" target="_blank">
<img alt="Share on Reddit" height="30" src="../../img/reddit-logo.svg" width="30"/>
</a>
<a class="button share-button" href="http://x.com/share?text=Check+out+this+post+entitled+%22Announcing+Chapel+2.1%21%22+on+the+Chapel+Programming+Language+blog%3A&amp;url=https%3A%2F%2Fchapel-lang.org%2Fblog%2Fposts%2Fannouncing-chapel-2.1%2F" rel="noopener noreferrer" style="--button-color: #000000; --button-color-light: #7a7a7a;" target="_blank">
<img alt="Share on X" height="30" src="../../img/x-logo.svg" width="30"/>
</a>
</div>
</div>
</div>
</body>
</html>
