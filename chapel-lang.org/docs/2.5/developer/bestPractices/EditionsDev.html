<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Editions &mdash; Chapel Documentation 2.5</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/theme.css?v=19f00094" />
      <link rel="stylesheet" type="text/css" href="../../_static/style.css?v=70f659a1" />

  
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../../_static/jquery.js?v=5d32c60e"></script>
        <script src="../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../../_static/documentation_options.js?v=3c4615cf"></script>
        <script src="../../_static/doctools.js?v=888ff710"></script>
        <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="How To Generate Warnings And Error Messages" href="ErrorWarningMessaging.html" />
    <link rel="prev" title="Examining/Debugging Compiler IR" href="CompilerIRTricks.html" />
   
  

</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

<a href="../../index.html" class="icon icon-home"> Chapel Documentation

<!-- display version if button won't be rendered -->
<?php if (false) { ?>
<br>2.5
<?php } ?>

</a>

<?php
// Variables given by sphinx
$chplTitle = "2.5";
$pagename = "developer/bestPractices/EditionsDev";
include "../..//versionButton.php";
?>


<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>


        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
  
              <p class="caption" role="heading"><span class="caption-text">Compiling and Running Chapel</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../usingchapel/QUICKSTART.html">Quickstart Instructions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../usingchapel/index.html">Using Chapel</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../platforms/index.html">Platform-Specific Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../technotes/index.html">Technical Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tools/index.html">Tools</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">Docs for Contributors</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="index.html">Best Practices for Contributors</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="GettingStarted.html">Getting Started</a></li>
<li class="toctree-l3"><a class="reference internal" href="ContributorInfo.html">Contributor Info</a></li>
<li class="toctree-l3"><a class="reference internal" href="DCO.html">Getting started with Chapel and the Developer Certificate of Origin (DCO)</a></li>
<li class="toctree-l3"><a class="reference internal" href="CompilerDebugging.html">Tips On Debugging The Compiler</a></li>
<li class="toctree-l3"><a class="reference internal" href="CompilerIRTricks.html">Examining/Debugging Compiler IR</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Editions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#new-editions-process">New Editions Process</a></li>
<li class="toctree-l4"><a class="reference internal" href="#associating-changes-with-an-edition">Associating Changes With An Edition</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="ErrorWarningMessaging.html">How To Generate Warnings And Error Messages</a></li>
<li class="toctree-l3"><a class="reference internal" href="RuntimeLibrary.html">The Chapel Runtime Library</a></li>
<li class="toctree-l3"><a class="reference internal" href="GeneratedCode.html">All About Compiler-Generated Code</a></li>
<li class="toctree-l3"><a class="reference internal" href="GASNetOnDesktops.html">Running Chapel Programs with GASNet on your Desktop</a></li>
<li class="toctree-l3"><a class="reference internal" href="git.html">Git tips for Chapel developers</a></li>
<li class="toctree-l3"><a class="reference internal" href="CHPL_DEVELOPER.html">The CHPL_DEVELOPER environment variable</a></li>
<li class="toctree-l3"><a class="reference internal" href="TestSystem.html">Chapel Testing System</a></li>
<li class="toctree-l3"><a class="reference internal" href="SpellChecking.html">chplspell</a></li>
<li class="toctree-l3"><a class="reference internal" href="Valgrind.html">Valgrind</a></li>
<li class="toctree-l3"><a class="reference internal" href="Sanitizers.html">Sanitizers</a></li>
<li class="toctree-l3"><a class="reference internal" href="Deprecation.html">Chapel’s Deprecation Policy</a></li>
<li class="toctree-l3"><a class="reference internal" href="Unstable.html">Unstable Features</a></li>
<li class="toctree-l3"><a class="reference internal" href="NightlyTesting.html">Nightly Testing</a></li>
<li class="toctree-l3"><a class="reference internal" href="StandardModuleStyle.html">Standard Module Style</a></li>
<li class="toctree-l3"><a class="reference internal" href="TestAnnotationsLocally.html">How to test ANNOTATIONS.yaml changes locally</a></li>
<li class="toctree-l3"><a class="reference internal" href="buildingdocs.html">Building Chapel Documentation</a></li>
<li class="toctree-l3"><a class="reference internal" href="Potpourri.html">Miscellaneous Notes</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../compiler-internals/index.html">Frontend Library API Docs</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Writing Chapel Programs</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../language/reference.html">Quick Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../examples/index.html">Hello World Variants</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../primers/index.html">Primers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../language/spec/index.html">Language Specification</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../modules/standard.html">Standard Modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../modules/packages.html">Package Modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../modules/layoutdist.html">Standard Layouts and Distributions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../mason-packages/index.html">Mason Packages</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../users-guide/index.html">Chapel Users Guide (WIP)</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Language History</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../language/evolution.html">Chapel Evolution</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../language/archivedSpecs.html">Documentation Archives</a></li>
</ul>

  <p class="caption" role="heading"><span class="caption-text">Indexes</span></p>
  <ul>
    <li class="toctree-11"><a class="reference internal" href="../../chpl-modindex.html">Chapel Module Index</a></li>
    <li class="toctree-11"><a class="reference internal" href="../../genindex.html">Complete Docs Index</a></li>
  </ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Chapel Documentation</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../index.html">Docs for Contributors</a></li>
          <li class="breadcrumb-item"><a href="index.html">Best Practices for Contributors</a></li>
      <li class="breadcrumb-item active">Editions</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/developer/bestPractices/EditionsDev.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="editions">
<span id="best-practices-editions"></span><h1>Editions<a class="headerlink" href="#editions" title="Link to this heading">¶</a></h1>
<section id="new-editions-process">
<h2>New Editions Process<a class="headerlink" href="#new-editions-process" title="Link to this heading">¶</a></h2>
<p>When creating new editions, be sure to:</p>
<ul class="simple">
<li><p>Add the new edition name to the array of editions in the compiler just
<strong>before</strong> <code class="docutils literal notranslate"><span class="pre">pre-edition</span></code>.</p></li>
<li><p>Update all desired changes that are currently associated with <code class="docutils literal notranslate"><span class="pre">pre-edition</span></code>
to be linked with this new edition name.</p>
<ul>
<li><p>Update <a class="reference internal" href="../../technotes/editions.html#edition-changes"><span class="std std-ref">Changes</span></a> to list those changes under this new release
name instead of under <a class="reference internal" href="../../technotes/editions.html#pre-edition-changes"><span class="std std-ref">Changes in the Pre-Edition</span></a>.</p></li>
</ul>
</li>
<li><p>When <a class="reference external" href="https://github.com/chapel-lang/chapel/issues/27336">https://github.com/chapel-lang/chapel/issues/27336</a> gets implemented, be
sure to update it as well.</p></li>
</ul>
</section>
<section id="associating-changes-with-an-edition">
<h2>Associating Changes With An Edition<a class="headerlink" href="#associating-changes-with-an-edition" title="Link to this heading">¶</a></h2>
<p>The implementation of editions is currently in progress.  Here are some
supported ways to tie a change to a particular edition.</p>
<section id="the-edition-attribute">
<span id="edition-attribute"></span><h3>The &#64;edition Attribute<a class="headerlink" href="#the-edition-attribute" title="Link to this heading">¶</a></h3>
<p>For breaking changes that can exist entirely in module code, the <code class="docutils literal notranslate"><span class="pre">&#64;edition</span></code>
attribute can be used.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">&#64;edition</span></code> attribute requires one or both of the following arguments:</p>
<ul class="simple">
<li><p>first</p>
<ul>
<li><p>To specify the earliest edition that will include this symbol.  When not
specified, will be the earliest supported edition.</p></li>
</ul>
</li>
<li><p>last</p>
<ul>
<li><p>To specify the final edition that will include this symbol.  When not
specified, will be <code class="docutils literal notranslate"><span class="pre">pre-edition</span></code>.</p></li>
</ul>
</li>
</ul>
<p>When using the attribute, the old behavior should be marked with
<code class="docutils literal notranslate"><span class="pre">&#64;edition(last=&quot;&lt;most</span> <span class="pre">recent</span> <span class="pre">edition</span> <span class="pre">name&gt;&quot;)</span></code>, while the new behavior should
be marked with <code class="docutils literal notranslate"><span class="pre">&#64;edition(first=&quot;pre-edition&quot;)</span></code>.  This will ensure that the
old behavior remains available with previous editions, while the new behavior
becomes available in the <code class="docutils literal notranslate"><span class="pre">pre-edition</span></code>.  E.g.,</p>
<div class="highlight-chapel notranslate"><div class="highlight"><pre><span></span><span class="k">@</span><span class="nd">edition</span><span class="p">(</span><span class="nx">first</span><span class="o">=</span><span class="s">&quot;pre-edition&quot;</span><span class="p">)</span>
<span class="k">proc</span> <span class="nf">foo</span><span class="p">(</span><span class="nx">x</span><span class="p">:</span> <span class="kt">int</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">writeln</span><span class="p">(</span><span class="s">&quot;in new edition foo with arg x=&quot;</span><span class="p">,</span> <span class="nx">x</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">@</span><span class="nd">edition</span><span class="p">(</span><span class="nx">last</span><span class="o">=</span><span class="s">&quot;2.0&quot;</span><span class="p">)</span>
<span class="k">proc</span> <span class="nf">foo</span><span class="p">(</span><span class="nx">x</span><span class="p">:</span> <span class="kt">int</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">writeln</span><span class="p">(</span><span class="s">&quot;in old edition foo with arg x=&quot;</span><span class="p">,</span> <span class="nx">x</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Though <code class="docutils literal notranslate"><span class="pre">default</span></code> is a supported value for the <code class="docutils literal notranslate"><span class="pre">--edition</span></code> compilation
flag, it is not supported for either the <code class="docutils literal notranslate"><span class="pre">first</span></code> or <code class="docutils literal notranslate"><span class="pre">last</span></code> argument of
the edition attribute.  These arguments must be concrete, specific editions,
to avoid potential implementation bugs.</p>
</div>
<p>Generally, specifying both <code class="docutils literal notranslate"><span class="pre">first</span></code> and <code class="docutils literal notranslate"><span class="pre">last</span></code> is most helpful if a feature
has been changed in multiple editions.  It is hoped that such occurrences will
be rare.</p>
</section>
<section id="compiler-changes">
<h3>Compiler Changes<a class="headerlink" href="#compiler-changes" title="Link to this heading">¶</a></h3>
<p>When making a change that should be supported by the compiler itself, one should
be careful to indicate the range of editions to which the change is applicable,
rather than specifying a single edition.  There is a helper function to use to
validate that the compiled edition is within a known first and last edition,
which can be used to determine if the change should apply.  There is also a
helper function to validate that the edition range specified itself is valid.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">Symbol</span></code> AST node in the production compiler will return the default
values listed in <a class="reference internal" href="#edition-attribute"><span class="std std-ref">The &#64;edition Attribute</span></a> if they are not explicitly provided.
This will be useful when extending attribute support to more than just function
resolution, but for specific compiler-level breaking changes the range will
likely have to be explicitly specified.</p>
<p>All known editions are stored in an array in the compiler in order, and the last
edition in the array is always <code class="docutils literal notranslate"><span class="pre">pre-edition</span></code>.</p>
</section>
<section id="runtime-changes">
<h3>Runtime Changes<a class="headerlink" href="#runtime-changes" title="Link to this heading">¶</a></h3>
<p>Since users will specify the edition to use via a compilation flag, it’s likely
better to avoid edition-specific computations in the runtime.  That doesn’t
preclude the possibility of needing certain implementation decisions to happen
at runtime, but in general it’s probably better to have done the computation of
which implementation to use based on the compiled edition during compilation.</p>
<p>As a concrete example, changing the printing behavior of nan in complex numbers
requires modifying our runtime I/O code
(<a class="reference external" href="https://github.com/chapel-lang/chapel/pull/27011">https://github.com/chapel-lang/chapel/pull/27011</a>).  The best way to handle this
is probably adding an argument to <code class="docutils literal notranslate"><span class="pre">qio_channel_print_complex</span></code> to indicate
which version of the implementation to use, and then using the attribute
solution in module code to switch between how that argument is set.  Something
like:</p>
<div class="highlight-chapel notranslate"><div class="highlight"><pre><span></span><span class="k">@</span><span class="nd">edition</span><span class="p">(</span><span class="nx">first</span><span class="o">=</span><span class="s">&quot;pre-edition&quot;</span><span class="p">)</span>
<span class="k">proc</span> <span class="nf">chpl_print_complex</span><span class="p">(</span><span class="o">..</span><span class="p">.)</span> <span class="p">{</span>
  <span class="k">return</span> <span class="nx">qio_channel_print_complex</span><span class="p">(</span><span class="kc">false</span><span class="p">,</span> <span class="nx">_channel_internal</span><span class="p">,</span> <span class="nx">re</span><span class="p">,</span> <span class="nx">im</span><span class="p">,</span>
                                   <span class="nx">numBytes</span><span class="p">(</span><span class="nx">re</span><span class="p">.</span><span class="kd">type</span><span class="p">),</span>
                                   <span class="cm">/* edition applicable */</span> <span class="kc">true</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">@</span><span class="nd">edition</span><span class="p">(</span><span class="nx">last</span><span class="o">=</span><span class="s">&quot;2.0&quot;</span><span class="p">)</span>
<span class="k">proc</span> <span class="nf">chpl_print_complex</span><span class="p">(</span><span class="o">..</span><span class="p">.)</span> <span class="p">{</span>
  <span class="k">return</span> <span class="nx">qio_channel_print_complex</span><span class="p">(</span><span class="kc">false</span><span class="p">,</span> <span class="nx">_channel_internal</span><span class="p">,</span> <span class="nx">re</span><span class="p">,</span> <span class="nx">im</span><span class="p">,</span>
                                   <span class="nx">numBytes</span><span class="p">(</span><span class="nx">re</span><span class="p">.</span><span class="kd">type</span><span class="p">),</span>
                                   <span class="cm">/* edition applicable */</span> <span class="kc">false</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p>This will make use of the existing edition computations in the compiler (saving
execution time performance), and allow the runtime code to use a descriptive
name for the argument that reflects the behavior being changed.  Alternatively,
a separate overload could be added to the runtime to handle the change.</p>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="CompilerIRTricks.html" class="btn btn-neutral float-left" title="Examining/Debugging Compiler IR" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="ErrorWarningMessaging.html" class="btn btn-neutral float-right" title="How To Generate Warnings And Error Messages" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, Hewlett Packard Enterprise Development LP.</p>
  </div>

   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>
 



</body>
</html>